# Biopesca março a outubro de 2023 ####
rm()
setwd("C:/Users/lg_ri/Dropbox/Postdoc/UNIOESTE/Relatórios Itaipu/R biopesca/Anual 2025")
library(readxl)
library(vegan)
library(tidyr)
library(dplyr)
library(ggplot2)
library(openxlsx)
library(lubridate)
BioAnual23 <- data.frame(read_xlsx("Biopesca_2025_ANUAL.xlsx", sheet="2025"))
BioAnual23 <- BioAnual23 %>%
  filter(tolower(Zona) != "montante")
Comp <- levels(factor(BioAnual23$Espécie))

Comp # Lista de espécie
BioAnual23$Mes <- format(BioAnual23$Data, "%b %Y") # Data em (mmm aaaa)
BioAnual23$Mes <- factor(BioAnual23$Mes)
BioAnual23$Seq <- seq(nrow(BioAnual23))

##################################
### VALORES
Preco<-BioAnual23[BioAnual23$Preço.Inteiro..Particular.>0,]
Preco<-Preco[-which(is.na(Preco$Preço.Inteiro..Particular.)),c("Zona","Espécie","Preço.Inteiro..Particular.")]
Preco
tapply(Preco$Preço.Inteiro..Particular.,interaction(Preco$Zona,Preco$Espécie), mean)
tapply(Preco$Preço.Inteiro..Particular.,interaction(Preco$Zona,Preco$Espécie), sd)
names(BioAnual23)

# Define a vector of names to be replaced
names_to_replace <- c("Ageneiosus inermis","Ageneiosus ucayalensis","Astronotus crassipinnis","Auchenipterus osteomystax","Catathyridium jenynsii",
                      "Cichla kelberi","Cichla piquiti","Geophagus sveni","Hemiodus orthonops","Hoplerythrinus unitaeniatus","Hoplias mbigua",
                      "Hoplias misionera","Hoplias sp. 3","Hypophthalmus oremaculatus","Hypostomus cochliodon","Hypostomus regani","Hypostomus ternetzi",
                      "Iheringichthys labrosus","Leporinus friderici","Leporinus lacustris","Loricariichthys platymetopon",
                      "Loricariichthys rostratus","Megalancistrus parananus","Megaleporinus macrocephalus","Megaleporinus obtusidens",
                      "Megaleporinus piavussu","Metynnis lippincottianus","Oreochromis niloticus","Piaractus mesopotamicus","Pimelodella avanhandavae",
                      "Pimelodus maculatus","Pimelodus mysteriosus","Pimelodus ornatus","Pinirampus pirinampu","Plagioscion squamosissimus",
                      "Potamotrygon amandae","Potamotrygon falkneri","Prochilodus lineatus","Pseudoplatystoma corruscans","Pterodoras granulosus",
                      "Pterygoplichthys ambrosettii","Rhaphiodon vulpinus","Rhinelepis aspera","Satanoperca setepele","Schizodon altoparanae",
                      "Schizodon borellii","Schizodon nasutus","Serrasalmus maculatus","Serrasalmus maculatus (preta)","Serrasalmus marginatus",
                      "Sorubim lima","Trachelyopterus galeatus","Traíra")

# Define corresponding replacement names
replacement_names <- c("Mandi","Mandi","Apaiari/Oscar","Mandi","Linguado","Tucunaré","Tucunaré","Cará","Piau","Jeju",
                       "Traíra","Traíra","Traíra","Perna de Moça","Cascudo","Cascudo","Cascudo","Mandi","Piau","Piau","Cascudo",
                       "Cascudo","Cascudo","Piavuçu","Piapara","Piapara","Pacu","Tilápia","Pacu","Mandi","Mandi","Mandi","Mandi","Barbado",
                       "Corvina","Raia","Raia","Curimba","Pintado","Armado","Cascudo","Dourado Cachorro","Cascudo","Cará","Piau","Piau","Piau",
                       "Piranha","Piranha","Piranha","Bico de Pato","Cangati","Traíra")


# Substitute names in Genero column
Preco$Espécie <- ifelse(Preco$Espécie %in% names_to_replace,
                        replacement_names[match(Preco$Espécie, names_to_replace)],
                        Preco$Espécie)

# Filter out lines where Genero is not in the list of replacement names
Preco <- Preco[Preco$Espécie %in% replacement_names, ]

# Overall summary data frame
overall_summary <- aggregate(Preço.Inteiro..Particular. ~ Espécie, data = Preco, 
                             FUN = function(x) c(mean = mean(x), sd = sd(x)))


# Create a new column indicating Zona as "Geral" for overall summary data
overall_summary$Zona <- "Geral"

# Reorder columns
#overall_summary <- overall_summary[, c(2, 1, 3, 4, 5)]

overall_summary<-as.data.frame(overall_summary)

colnames(overall_summary)<-c("Espécies", "Preço", "Zona")

overall_summary$Preço_mean <- overall_summary$Preço[,1]
overall_summary$Preço_sd <- overall_summary$Preço[,2]

overall_summary <- overall_summary[, -2]

write.xlsx(overall_summary, file = "Preço geral peixe inteiro particular.xlsx")

# Zona-specific summary data frame
zona_summary <- aggregate(Preço.Inteiro..Particular. ~ Espécie + Zona, data = Preco, 
                          FUN = function(x) c(mean = mean(x), sd = sd(x)))

# Order zona_summary by Genero
zona_summary <- zona_summary %>% 
  arrange(Espécie)

# Define the complete set of Genero and Zona combinations
complete_set <- expand.grid(Espécie = unique(zona_summary$Espécie), 
                            Zona = c("Fluvial", "Transição", "Lacustre"))

# Merge zona_summary with the complete set to add missing combinations
zona_summary_complete <- merge(zona_summary, complete_set, by = c("Espécie", "Zona"), all = TRUE)

# Order the Zonas
zona_summary_complete$Zona <- factor(zona_summary_complete$Zona, levels = c("Fluvial", "Transição", "Lacustre"))

# Order zona_summary_complete by Genero and Zona
zona_summary_complete <- zona_summary_complete %>% 
  arrange(Espécie, Zona)

colnames(zona_summary_complete)<-c("Espécies","Zona", "Preço")

zona_summary_complete$Preço_mean <- zona_summary_complete$Preço[,1]
zona_summary_complete$Preço_sd <- zona_summary_complete$Preço[,2]

zona_summary_complete <- zona_summary_complete[, -3]

write.xlsx(zona_summary_complete, file = "Preço por zona peixe inteiro particular.xlsx")

#####################
### VALORES
Preco<-BioAnual23[BioAnual23$Preço.Filé..Particular.>0,]
Preco<-Preco[-which(is.na(Preco$Preço.Filé..Particular.)),c("Zona","Espécie","Preço.Filé..Particular.")]
Preco
tapply(Preco$Preço.Filé..Particular.,interaction(Preco$Zona,Preco$Espécie), mean)
tapply(Preco$Preço.Filé..Particular.,interaction(Preco$Zona,Preco$Espécie), sd)
names(BioAnual23)

# Define a vector of names to be replaced
names_to_replace <- c("Ageneiosus inermis","Ageneiosus ucayalensis","Astronotus crassipinnis","Auchenipterus osteomystax","Catathyridium jenynsii",
                      "Cichla kelberi","Cichla piquiti","Geophagus sveni","Hemiodus orthonops","Hoplerythrinus unitaeniatus","Hoplias mbigua",
                      "Hoplias misionera","Hoplias sp. 3","Hypophthalmus oremaculatus","Hypostomus cochliodon","Hypostomus regani","Hypostomus ternetzi",
                      "Iheringichthys labrosus","Leporinus friderici","Leporinus lacustris","Loricariichthys platymetopon",
                      "Loricariichthys rostratus","Megalancistrus parananus","Megaleporinus macrocephalus","Megaleporinus obtusidens",
                      "Megaleporinus piavussu","Metynnis lippincottianus","Oreochromis niloticus","Piaractus mesopotamicus","Pimelodella avanhandavae",
                      "Pimelodus maculatus","Pimelodus mysteriosus","Pimelodus ornatus","Pinirampus pirinampu","Plagioscion squamosissimus",
                      "Potamotrygon amandae","Potamotrygon falkneri","Prochilodus lineatus","Pseudoplatystoma corruscans","Pterodoras granulosus",
                      "Pterygoplichthys ambrosettii","Rhaphiodon vulpinus","Rhinelepis aspera","Satanoperca setepele","Schizodon altoparanae",
                      "Schizodon borellii","Schizodon nasutus","Serrasalmus maculatus","Serrasalmus maculatus (preta)","Serrasalmus marginatus",
                      "Sorubim lima","Trachelyopterus galeatus","Traíra")

# Define corresponding replacement names
replacement_names <- c("Mandi","Mandi","Apaiari/Oscar","Mandi","Linguado","Tucunaré","Tucunaré","Cará","Piau","Jeju",
                       "Traíra","Traíra","Traíra","Perna de Moça","Cascudo","Cascudo","Cascudo","Mandi","Piau","Piau","Cascudo",
                       "Cascudo","Cascudo","Piavuçu","Piapara","Piapara","Pacu","Tilápia","Pacu","Mandi","Mandi","Mandi","Mandi","Barbado",
                       "Corvina","Raia","Raia","Curimba","Pintado","Armado","Cascudo","Dourado Cachorro","Cascudo","Cará","Piau","Piau","Piau",
                       "Piranha","Piranha","Piranha","Bico de Pato","Cangati","Traíra")


# Substitute names in Genero column
Preco$Espécie <- ifelse(Preco$Espécie %in% names_to_replace,
                        replacement_names[match(Preco$Espécie, names_to_replace)],
                        Preco$Espécie)

# Filter out lines where Genero is not in the list of replacement names
Preco <- Preco[Preco$Espécie %in% replacement_names, ]

# Overall summary data frame
overall_summary <- aggregate(Preço.Filé..Particular. ~ Espécie, data = Preco, 
                             FUN = function(x) c(mean = mean(x), sd = sd(x)))


# Create a new column indicating Zona as "Geral" for overall summary data
overall_summary$Zona <- "Geral"

# Reorder columns
#overall_summary <- overall_summary[, c(2, 1, 3, 4, 5)]

overall_summary<-as.data.frame(overall_summary)

colnames(overall_summary)<-c("Espécies", "Preço", "Zona")

overall_summary$Preço_mean <- overall_summary$Preço[,1]
overall_summary$Preço_sd <- overall_summary$Preço[,2]

overall_summary <- overall_summary[, -2]

write.xlsx(overall_summary, file = "Preço geral peixe filé particular.xlsx")

# Zona-specific summary data frame
zona_summary <- aggregate(Preço.Filé..Particular. ~ Espécie + Zona, data = Preco, 
                          FUN = function(x) c(mean = mean(x), sd = sd(x)))

# Order zona_summary by Genero
zona_summary <- zona_summary %>% 
  arrange(Espécie)

# Define the complete set of Genero and Zona combinations
complete_set <- expand.grid(Espécie = unique(zona_summary$Espécie), 
                            Zona = c("Fluvial", "Transição", "Lacustre"))

# Merge zona_summary with the complete set to add missing combinations
zona_summary_complete <- merge(zona_summary, complete_set, by = c("Espécie", "Zona"), all = TRUE)

# Order the Zonas
zona_summary_complete$Zona <- factor(zona_summary_complete$Zona, levels = c("Fluvial", "Transição", "Lacustre"))

# Order zona_summary_complete by Genero and Zona
zona_summary_complete <- zona_summary_complete %>% 
  arrange(Espécie, Zona)

colnames(zona_summary_complete)<-c("Espécies","Zona", "Preço")

zona_summary_complete$Preço_mean <- zona_summary_complete$Preço[,1]
zona_summary_complete$Preço_sd <- zona_summary_complete$Preço[,2]

zona_summary_complete <- zona_summary_complete[, -3]

write.xlsx(zona_summary_complete, file = "Preço por zona peixe filé particular.xlsx")

#####################
##############
### VALORES
Preco<-BioAnual23[BioAnual23$Preço.Inteiro..Peixeiro.>0,]
Preco<-Preco[-which(is.na(Preco$Preço.Inteiro..Peixeiro.)),c("Zona","Espécie","Preço.Inteiro..Peixeiro.")]
Preco
tapply(Preco$Preço.Inteiro..Peixeiro.,interaction(Preco$Zona,Preco$Espécie), mean)
tapply(Preco$Preço.Inteiro..Peixeiro.,interaction(Preco$Zona,Preco$Espécie), sd)
names(BioAnual23)

# Define a vector of names to be replaced
names_to_replace <- c("Ageneiosus inermis","Ageneiosus ucayalensis","Astronotus crassipinnis","Auchenipterus osteomystax","Catathyridium jenynsii",
                      "Cichla kelberi","Cichla piquiti","Geophagus sveni","Hemiodus orthonops","Hoplerythrinus unitaeniatus","Hoplias mbigua",
                      "Hoplias misionera","Hoplias sp. 3","Hypophthalmus oremaculatus","Hypostomus cochliodon","Hypostomus regani","Hypostomus ternetzi",
                      "Iheringichthys labrosus","Leporinus friderici","Leporinus lacustris","Loricariichthys platymetopon",
                      "Loricariichthys rostratus","Megalancistrus parananus","Megaleporinus macrocephalus","Megaleporinus obtusidens",
                      "Megaleporinus piavussu","Metynnis lippincottianus","Oreochromis niloticus","Piaractus mesopotamicus","Pimelodella avanhandavae",
                      "Pimelodus maculatus","Pimelodus mysteriosus","Pimelodus ornatus","Pinirampus pirinampu","Plagioscion squamosissimus",
                      "Potamotrygon amandae","Potamotrygon falkneri","Prochilodus lineatus","Pseudoplatystoma corruscans","Pterodoras granulosus",
                      "Pterygoplichthys ambrosettii","Rhaphiodon vulpinus","Rhinelepis aspera","Satanoperca setepele","Schizodon altoparanae",
                      "Schizodon borellii","Schizodon nasutus","Serrasalmus maculatus","Serrasalmus maculatus (preta)","Serrasalmus marginatus",
                      "Sorubim lima","Trachelyopterus galeatus","Traíra")

# Define corresponding replacement names
replacement_names <- c("Mandi","Mandi","Apaiari/Oscar","Mandi","Linguado","Tucunaré","Tucunaré","Cará","Piau","Jeju",
                       "Traíra","Traíra","Traíra","Perna de Moça","Cascudo","Cascudo","Cascudo","Mandi","Piau","Piau","Cascudo",
                       "Cascudo","Cascudo","Piavuçu","Piapara","Piapara","Pacu","Tilápia","Pacu","Mandi","Mandi","Mandi","Mandi","Barbado",
                       "Corvina","Raia","Raia","Curimba","Pintado","Armado","Cascudo","Dourado Cachorro","Cascudo","Cará","Piau","Piau","Piau",
                       "Piranha","Piranha","Piranha","Bico de Pato","Cangati","Traíra")


# Substitute names in Genero column
Preco$Espécie <- ifelse(Preco$Espécie %in% names_to_replace,
                        replacement_names[match(Preco$Espécie, names_to_replace)],
                        Preco$Espécie)

# Filter out lines where Genero is not in the list of replacement names
Preco <- Preco[Preco$Espécie %in% replacement_names, ]

# Overall summary data frame
overall_summary <- aggregate(Preço.Inteiro..Peixeiro. ~ Espécie, data = Preco, 
                             FUN = function(x) c(mean = mean(x), sd = sd(x)))


# Create a new column indicating Zona as "Geral" for overall summary data
overall_summary$Zona <- "Geral"

# Reorder columns
#overall_summary <- overall_summary[, c(2, 1, 3, 4, 5)]

overall_summary<-as.data.frame(overall_summary)

colnames(overall_summary)<-c("Espécies", "Preço", "Zona")

overall_summary$Preço_mean <- overall_summary$Preço[,1]
overall_summary$Preço_sd <- overall_summary$Preço[,2]

overall_summary <- overall_summary[, -2]

write.xlsx(overall_summary, file = "Preço geral peixe inteiro peixeiro.xlsx")

# Zona-specific summary data frame
zona_summary <- aggregate(Preço.Inteiro..Peixeiro. ~ Espécie + Zona, data = Preco, 
                          FUN = function(x) c(mean = mean(x), sd = sd(x)))

# Order zona_summary by Genero
zona_summary <- zona_summary %>% 
  arrange(Espécie)

# Define the complete set of Genero and Zona combinations
complete_set <- expand.grid(Espécie = unique(zona_summary$Espécie), 
                            Zona = c("Fluvial", "Transição", "Lacustre"))

# Merge zona_summary with the complete set to add missing combinations
zona_summary_complete <- merge(zona_summary, complete_set, by = c("Espécie", "Zona"), all = TRUE)

# Order the Zonas
zona_summary_complete$Zona <- factor(zona_summary_complete$Zona, levels = c("Fluvial", "Transição", "Lacustre"))

# Order zona_summary_complete by Genero and Zona
zona_summary_complete <- zona_summary_complete %>% 
  arrange(Espécie, Zona)

colnames(zona_summary_complete)<-c("Espécies","Zona", "Preço")

zona_summary_complete$Preço_mean <- zona_summary_complete$Preço[,1]
zona_summary_complete$Preço_sd <- zona_summary_complete$Preço[,2]

zona_summary_complete <- zona_summary_complete[, -3]

write.xlsx(zona_summary_complete, file = "Preço por zona peixe inteiro peixeiro.xlsx")

#####################
##############
### VALORES
Preco<-BioAnual23[BioAnual23$Preço.Filé..Peixeiro.>0,]
Preco<-Preco[-which(is.na(Preco$Preço.Filé..Peixeiro.)),c("Zona","Espécie","Preço.Filé..Peixeiro.")]
Preco
tapply(Preco$Preço.Filé..Peixeiro.,interaction(Preco$Zona,Preco$Espécie), mean)
tapply(Preco$Preço.Filé..Peixeiro.,interaction(Preco$Zona,Preco$Espécie), sd)
names(BioAnual23)

# Define a vector of names to be replaced
names_to_replace <- c("Ageneiosus inermis","Ageneiosus ucayalensis","Astronotus crassipinnis","Auchenipterus osteomystax","Catathyridium jenynsii",
                      "Cichla kelberi","Cichla piquiti","Geophagus sveni","Hemiodus orthonops","Hoplerythrinus unitaeniatus","Hoplias mbigua",
                      "Hoplias misionera","Hoplias sp. 3","Hypophthalmus oremaculatus","Hypostomus cochliodon","Hypostomus regani","Hypostomus ternetzi",
                      "Iheringichthys labrosus","Leporinus friderici","Leporinus lacustris","Loricariichthys platymetopon",
                      "Loricariichthys rostratus","Megalancistrus parananus","Megaleporinus macrocephalus","Megaleporinus obtusidens",
                      "Megaleporinus piavussu","Metynnis lippincottianus","Oreochromis niloticus","Piaractus mesopotamicus","Pimelodella avanhandavae",
                      "Pimelodus maculatus","Pimelodus mysteriosus","Pimelodus ornatus","Pinirampus pirinampu","Plagioscion squamosissimus",
                      "Potamotrygon amandae","Potamotrygon falkneri","Prochilodus lineatus","Pseudoplatystoma corruscans","Pterodoras granulosus",
                      "Pterygoplichthys ambrosettii","Rhaphiodon vulpinus","Rhinelepis aspera","Satanoperca setepele","Schizodon altoparanae",
                      "Schizodon borellii","Schizodon nasutus","Serrasalmus maculatus","Serrasalmus maculatus (preta)","Serrasalmus marginatus",
                      "Sorubim lima","Trachelyopterus galeatus","Traíra")

# Define corresponding replacement names
replacement_names <- c("Mandi","Mandi","Apaiari/Oscar","Mandi","Linguado","Tucunaré","Tucunaré","Cará","Piau","Jeju",
                       "Traíra","Traíra","Traíra","Perna de Moça","Cascudo","Cascudo","Cascudo","Mandi","Piau","Piau","Cascudo",
                       "Cascudo","Cascudo","Piavuçu","Piapara","Piapara","Pacu","Tilápia","Pacu","Mandi","Mandi","Mandi","Mandi","Barbado",
                       "Corvina","Raia","Raia","Curimba","Pintado","Armado","Cascudo","Dourado Cachorro","Cascudo","Cará","Piau","Piau","Piau",
                       "Piranha","Piranha","Piranha","Bico de Pato","Cangati","Traíra")


# Substitute names in Genero column
Preco$Espécie <- ifelse(Preco$Espécie %in% names_to_replace,
                        replacement_names[match(Preco$Espécie, names_to_replace)],
                        Preco$Espécie)

# Filter out lines where Genero is not in the list of replacement names
Preco <- Preco[Preco$Espécie %in% replacement_names, ]

# Overall summary data frame
overall_summary <- aggregate(Preço.Filé..Peixeiro. ~ Espécie, data = Preco, 
                             FUN = function(x) c(mean = mean(x), sd = sd(x)))


# Create a new column indicating Zona as "Geral" for overall summary data
overall_summary$Zona <- "Geral"

# Reorder columns
#overall_summary <- overall_summary[, c(2, 1, 3, 4, 5)]

overall_summary<-as.data.frame(overall_summary)

colnames(overall_summary)<-c("Espécies", "Preço", "Zona")

overall_summary$Preço_mean <- overall_summary$Preço[,1]
overall_summary$Preço_sd <- overall_summary$Preço[,2]

overall_summary <- overall_summary[, -2]

write.xlsx(overall_summary, file = "Preço geral peixe filé peixeiro.xlsx")

# Zona-specific summary data frame
zona_summary <- aggregate(Preço.Filé..Peixeiro. ~ Espécie + Zona, data = Preco, 
                          FUN = function(x) c(mean = mean(x), sd = sd(x)))

# Order zona_summary by Genero
zona_summary <- zona_summary %>% 
  arrange(Espécie)

# Define the complete set of Genero and Zona combinations
complete_set <- expand.grid(Espécie = unique(zona_summary$Espécie), 
                            Zona = c("Fluvial", "Transição", "Lacustre"))

# Merge zona_summary with the complete set to add missing combinations
zona_summary_complete <- merge(zona_summary, complete_set, by = c("Espécie", "Zona"), all = TRUE)

# Order the Zonas
zona_summary_complete$Zona <- factor(zona_summary_complete$Zona, levels = c("Fluvial", "Transição", "Lacustre"))

# Order zona_summary_complete by Genero and Zona
zona_summary_complete <- zona_summary_complete %>% 
  arrange(Espécie, Zona)

colnames(zona_summary_complete)<-c("Espécies","Zona", "Preço")

zona_summary_complete$Preço_mean <- zona_summary_complete$Preço[,1]
zona_summary_complete$Preço_sd <- zona_summary_complete$Preço[,2]

zona_summary_complete <- zona_summary_complete[, -3]

write.xlsx(zona_summary_complete, file = "Preço por zona peixe filé peixeiro.xlsx")

######################################## RPD vs. rest
# Convert the date column to Date format and extract year and month
BioAnual23 <- BioAnual23 %>%
  mutate(Data = as.Date(Data),
         Year = year(Data),
         Month = month(Data, label = TRUE, abbr = TRUE))

# Summarize data: calculate the total count and count for Estágio RPD for each month
data_summary <- BioAnual23 %>%
  filter(Year %in% c(2023, 2024)) %>%
  group_by(Year, Month, Estagio) %>%
  summarise(Count = n(), .groups = "drop") %>%
  group_by(Year, Month) %>%
  mutate(Total = sum(Count),
         Percent = (Count / Total) * 100) %>%
  filter(Estagio == "RPD")  # Keep only rows for Estágio RPD

# Plot for 2023
plot_2023 <- ggplot(data_summary %>% filter(Year == 2023), aes(x = Month, y = Percent)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  theme_minimal() +
  labs(title = "Percentage of Estágio RPD per Month (2023)",
       x = "Month", y = "Percentage (%) of RPD")

plot_2024 <- ggplot(data_summary %>% filter(Year == 2024), aes(x = Month, y = Percent)) +
  geom_bar(stat = "identity", fill = "darkorange") +
  theme_minimal() +
  labs(title = "Porcentagem de peixes em reprodução por mês (2024)",
       x = "", y = "") +
  theme(
    axis.title = element_text(size = 16, face = "bold"),   # Increase axis title size
    axis.text = element_text(size = 14),                  # Increase axis text size
    plot.title = element_text(size = 18, face = "bold"),  # Increase title size
    axis.ticks.length = unit(0.25, "cm"), 
    panel.grid = element_blank()                          # Remove grid lines
  ) +
  scale_y_continuous(limits = c(0, 20), breaks = seq(0, 20, 5), 
                     labels = function(x) paste0(x, "%")) +  # Add % symbol to Y-axis labels
  geom_vline(xintercept = 0.5, color = "black", size = 1) +  # Add Y-axis line
  geom_hline(yintercept = 0, color = "black", size = 1)      # Add X-axis line

# Print the plots
plot_2023
plot_2024
